<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dashboard â€” Ads Click Pay</title>
  <link rel="stylesheet" href="css/style.css" />
  <script src="js/main.js" defer></script>
  <script src="js/auth.js" defer></script>
</head>
<body>
  <div class="container">
    <div class="topbar">
      <div class="brand"><div class="logo">ðŸ“Š</div><h1>Dashboard</h1></div>
      <div class="nav">
        <a href="earn.html">Earn</a>
        <a href="tasks.html">Tasks</a>
        <a href="referral.html">Referral</a>
        <a href="withdraw.html">Withdraw</a>
        <a href="profile.html">Profile</a>
      </div>
    </div>

    <main>
      <section class="card small" id="welcomeCard">
        <h2 id="welcomeUser">Welcome</h2>
        <div class="grid">
          <div><strong>Balance</strong><div id="bal">$0.0000</div></div>
          <div><strong>Referrals</strong><div id="refCount">0</div></div>
        </div>
        <div style="margin-top:12px"><a class="btn btn-primary" href="earn.html">Start Earning ðŸ’¸</a></div>
      </section>

      <section class="card" id="recent">
        <h3>Recent Withdrawals</h3>
        <ul id="recentList" class="list"></ul>
      </section>
    </main>
  </div>

  <script>
    (function(){
      const cur = JSON.parse(localStorage.getItem('acp_user')||'null');
      if(!cur) return location.href='login.html';
      const db = JSON.parse(localStorage.getItem('acp_db_v1')||'{}');
      const u = (db.users||[]).find(x=>x.email===cur.email);
      if(!u) return location.href='login.html';
      document.getElementById('welcomeUser').innerText = 'Welcome, ' + (u.username||cur.email);
      document.getElementById('bal').innerText = (function(v){ return '$' + Number(v||0).toFixed(4) })(u.balance);
      document.getElementById('refCount').innerText = (u.referrals||[]).length;
      const list = document.getElementById('recentList'); list.innerHTML='';
      (db.withdraws||[]).slice().reverse().forEach(w=>{
        if(w.email===cur.email){
          const li=document.createElement('li'); li.textContent = `${w.createdAt.split('T')[0]} â€” $${Number(w.amount).toFixed(4)} â€” ${w.status}`; list.appendChild(li);
        }
      });
    })();
  </script>
</body>
</html>
